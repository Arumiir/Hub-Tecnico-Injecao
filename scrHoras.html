<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>Simulador de Produção</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

<style>
* { box-sizing: border-box; user-select: none; margin: 0; padding: 0; }

body {
    font-family: "Segoe UI", Arial, sans-serif;
    background: #f2f4f6;
    color: #1e1e1e;
    min-height: 100vh;
    display: flex;
    justify-content: center;
}

.app {
    width: 100%;
    max-width: 480px;
    height: 100vh;
    display: flex;
    flex-direction: column;
}

.header {
    position: fixed;
    top: 0;
    width: 100%;
    max-width: 480px;
    background: #fff;
    border-bottom: 1px solid #ddd;
    padding: 16px 20px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    z-index: 100;
}

.content {
    flex: 1;
    padding: 80px 20px 20px;
    overflow-y: auto;
}

.card {
    background: #fff;
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 16px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.05);
}

.slide { display: none; }
.slide.active { display: block; }

label { display: block; margin-top: 12px; font-size: 14px; }
input, select {
    width: 100%;
    padding: 12px;
    margin-top: 5px;
    border-radius: 8px;
    border: 1px solid #ccc;
}

.buttons {
    display: flex;
    gap: 12px;
    margin-top: 20px;
}

button {
    flex: 1;
    padding: 14px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    background: #005bbb;
    color: #fff;
    font-weight: 600;
}

button.secondary {
    background: #ddd;
    color: #1e1e1e;
}

.erro {
    margin-top: 12px;
    color: #ff4c4c;
    font-weight: bold;
}

.resultado-grid {
    display: grid;
    gap: 14px;
    margin-top: 20px;
}

.caixa {
    background: #fff;
    padding: 14px;
    border-radius: 8px;
    border-left: 4px solid #005bbb;
}

.status {
    margin-top: 16px;
    font-weight: bold;
    text-align: center;
    color: #005bbb;
}
</style>
</head>

<body>
<div class="app">

<div class="header">
    <i class="fas fa-arrow-left" onclick="history.back()"></i>
    <strong>Simulador de Produção</strong>
    <span></span>
</div>

<div class="content">

<div class="slide active">
<div class="card">
<h2>Parâmetros</h2>
<label>Padrão hora carga</label>
<input id="padraoHora" placeholder="146">
<label>Estágios</label>
<select id="estagios">
<option value="">Selecione</option>
<option value="12">12</option>
<option value="18">18</option>
</select>
<label>Matrizes</label>
<input id="matrizes" placeholder="1">
<div class="erro" id="erro1"></div>
<div class="buttons">
<button onclick="validarSlide1()">Próximo</button>
</div>
</div>
</div>

<div class="slide">
<div class="card">
<h2>Caixas</h2>
<label>Pares por caixa</label>
<input id="paresCaixa" placeholder="17">
<label>Etiquetas</label>
<input id="etiquetas" placeholder="12">
<label>Pares última</label>
<input id="paresUltima" placeholder="11">
<div class="erro" id="erro2"></div>
<div class="buttons">
<button class="secondary" onclick="prev()">Voltar</button>
<button onclick="validarSlide2()">Próximo</button>
</div>
</div>
</div>

<div class="slide">
<div class="card">
<h2>Meta</h2>
<label>Produzido (HH:MM)</label>
<input id="produzido" placeholder="06:35">
<label>Meta (HH:MM)</label>
<input id="meta" placeholder="08:50">
<div class="erro" id="erro3"></div>
<div class="buttons">
<button class="secondary" onclick="prev()">Voltar</button>
<button onclick="validarSlide3()">Calcular</button>
</div>
</div>
</div>

<div class="slide">
<div class="card">
<h2>Resultado</h2>
<div id="resultado" class="resultado-grid"></div>
<div id="status" class="status"></div>
<div class="buttons">
<button class="secondary" onclick="prev()">Voltar</button>
<button onclick="location.reload()">Reiniciar</button>
</div>
</div>
</div>

</div>
</div>

<script>
let slideAtual = 0;
const slides = document.querySelectorAll(".slide");

function next(){slides[slideAtual].classList.remove("active");slideAtual++;slides[slideAtual].classList.add("active");}
function prev(){slides[slideAtual].classList.remove("active");slideAtual--;slides[slideAtual].classList.add("active");}

function validarSlide1(){
if(!padraoHora.value||!estagios.value||!matrizes.value){erro1.textContent="Preencha tudo";return;}
erro1.textContent="";next();
}
function validarSlide2(){
if(!paresCaixa.value||!etiquetas.value||!paresUltima.value){erro2.textContent="Preencha tudo";return;}
erro2.textContent="";next();
}
function validarSlide3(){
if(!meta.value){erro3.textContent="Informe a meta";return;}
erro3.textContent="";calcular();
}

function hhmmParaMin(v){if(!v)return 0;let[t,m]=v.split(":").map(Number);return t*60+m;}
function minParaHHMM(m){let h=Math.floor(m/60);let mm=Math.round(m%60);return`${String(h).padStart(2,"0")}:${String(mm).padStart(2,"0")}`;}

function calcular(){
const prodHora=(padraoHora.value/estagios.value)*matrizes.value;
const tempoPar=60/prodHora;

const inicio=hhmmParaMin(produzido.value);
const alvo=hhmmParaMin(meta.value);

let caixas=[];
for(let i=1;i<=+etiquetas.value;i++){
let pares=(i==etiquetas.value)?+paresUltima.value:+paresCaixa.value;
caixas.push({i,tempo:pares*tempoPar});
}

let melhor=null;
let soma=0;

for(let i=0;i<caixas.length;i++){
soma+=caixas[i].tempo;
let final=inicio+soma;
let diff=Math.abs(final-alvo);

if(!melhor ||
(final>=alvo && diff<melhor.diff) ||
(final<alvo && melhor.final<alvo && diff<melhor.diff)){
melhor={qtd:i+1,final,diff};
}
}

resultado.innerHTML="";
let total=inicio;
for(let i=0;i<melhor.qtd;i++){
total+=caixas[i].tempo;
resultado.innerHTML+=`
<div class="caixa">
<strong>Caixa ${i+1}</strong>
<span>${minParaHHMM(total)}</span>
</div>`;
}

status.textContent=`Resultado mais próximo da meta (${minParaHHMM(melhor.final)})`;
next();
}
</script>

</body>
</html>